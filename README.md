# æ‹¼æ‹¼ä¸­å›½ (PinPin China) - Web Game

PinPin China æ˜¯ä¸€æ¬¾åŸºäº Web çš„ä¸­å›½åœ°å›¾æ‹¼å›¾ä¸åœ°ç†çŸ¥è¯†é—®ç­”æ¸¸æˆã€‚ç©å®¶é€šè¿‡æ‹–æ‹½çœä»½æ‹¼å›¾è¿˜åŸä¸­å›½åœ°å›¾ï¼Œå¹¶é€šè¿‡å¿«é€Ÿååº”çš„æ¸¸æˆæ¨¡å¼å¼ºåŒ–å¯¹çœä¼šåŸå¸‚çš„è®°å¿†ã€‚

## ğŸ® æ¸¸æˆå†…å®¹ (Gameplay)

### Level 1: Magnetic Map (ç£åŠ›æ‹¼å›¾)
*   **ç›®æ ‡**: è¿˜åŸä¸­å›½åœ°å›¾ã€‚
*   **ç©æ³•**: 34 ä¸ªçœä»½æ‹¼å›¾æ•£è½åœ¨å±å¹•ä¸¤ä¾§ï¼Œç©å®¶éœ€è¦å°†å…¶æ‹–æ‹½åˆ°åœ°å›¾ä¸­å¤®çš„æ­£ç¡®ä½ç½®ã€‚æ‹¼å›¾æ¥è¿‘æ­£ç¡®ä½ç½®æ—¶ä¼šè‡ªåŠ¨å¸é™„ (Magnetic Snap)ã€‚
*   **ç‰¹è‰²**: 
    *   **èŒåŒ–é£æ ¼**: æ¯ä¸ªæ‹¼å›¾å¸¦æœ‰å¯çˆ±çš„è¡¨æƒ…å’Œ 3D é˜´å½±ã€‚
    *   **äº¤äº’ä¼˜åŒ–**: æ‹¼å›¾æ”¯æŒæ‚¬åœé«˜äº®ï¼Œæ‹–ä¸¾æ—¶æœ‰å¼¹è·³åé¦ˆã€‚
    *   **è§†è§‰å¼•å¯¼**: ç›®æ ‡åŒºåŸŸæœ‰æ¸…æ™°çš„è½®å»“æç¤ºã€‚

### Level 2: Capital Rain (çœä¼šé›¨)
*   **ç›®æ ‡**: åŒ¹é…çœä»½å½¢çŠ¶ä¸å…¶å¯¹åº”çš„çœä¼šåç§°ã€‚
*   **ç©æ³•**: å±å¹•ä¸Šæ–¹ä¸æ–­æ‰è½â€œçœä»½å½¢çŠ¶â€å’Œâ€œçœä¼šåç§°â€æ–¹å—ã€‚ç©å®¶éœ€è¦ç‚¹å‡»é€‰è¿™ä¸¤ä¸ªå¯¹åº”çš„æ–¹å—è¿›è¡Œæ¶ˆé™¤ã€‚
*   **æŒ‘æˆ˜**: 
    *   **Miss æƒ©ç½š**: æ‰è½åˆ°åº•éƒ¨ä¼šæ‰£é™¤ç”Ÿå‘½å€¼ (åˆå§‹ 5 å‘½)ã€‚
    *   **é”™è¯¯æƒ©ç½š**: åŒ¹é…é”™è¯¯ä¼šéœ‡åŠ¨å±å¹•å¹¶æ’­æ”¾é”™è¯¯éŸ³æ•ˆã€‚
    *   **éš¾åº¦é€’å¢**: éšç€æ—¶é—´æ¨ç§»ï¼Œæ‰è½é€Ÿåº¦ä¼šé€æ¸åŠ å¿«ã€‚

---

## ğŸ›  æŠ€æœ¯æ¶æ„ (Tech Stack)

*   **Core Engine**: [Phaser 3](https://phaser.io/) (v3.80+) - å¼ºå¤§çš„ 2D æ¸¸æˆå¼•æ“ï¼Œå¤„ç†æ¸²æŸ“ã€ç‰©ç†å’Œåœºæ™¯ç®¡ç†ã€‚
*   **Language**: [TypeScript](https://www.typescriptlang.org/) - å¼ºç±»å‹ JavaScriptï¼Œä¿è¯ä»£ç å¥å£®æ€§ã€‚
*   **Build Tool**: [Vite](https://vitejs.dev/) - æé€Ÿçš„ç°ä»£å‰ç«¯æ„å»ºå·¥å…·ã€‚
*   **Data Pipeline**: 
    *   æºæ•°æ®: GeoJSON (ä¸­å›½è¡Œæ”¿åŒºåˆ’æ•°æ®)ã€‚
    *   å¤„ç†è„šæœ¬: `scripts/build-map-data.ts` (åŸºäº `d3-geo` æŠ•å½±å’Œ `simplify-js` ä¼˜åŒ–)ã€‚
    *   è¿è¡Œæ—¶æ•°æ®: `src/assets/map_data.json` (åŒ…å«é¢„è®¡ç®—çš„è·¯å¾„ç‚¹å’Œè¾¹ç•Œæ¡†)ã€‚
*   **Audio**: Web Audio API (é€šè¿‡ `SoundManager` å®ç°åˆæˆéŸ³æ•ˆï¼Œæ— éœ€å¤–éƒ¨éŸ³é¢‘èµ„æº)ã€‚

---

## ğŸ“‚ é¡¹ç›®ç»“æ„ (Project Structure)

```
/
â”œâ”€â”€ scripts/                # æ„å»ºè„šæœ¬
â”‚   â””â”€â”€ build-map-data.ts   # GeoJSON -> Game JSON è½¬æ¢å·¥å…·
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ assets/             # é™æ€èµ„æº (ç”Ÿæˆçš„ map_data.json)
â”‚   â”œâ”€â”€ data/               # æ¸¸æˆæ•°æ®
â”‚   â”‚   â””â”€â”€ capitals.ts     # çœä»½ -> çœä¼š æ˜ å°„è¡¨
â”‚   â”œâ”€â”€ objects/            # æ¸¸æˆå¯¹è±¡ (GameObjects)
â”‚   â”‚   â”œâ”€â”€ MapPiece.ts     # æ‹¼å›¾å— (äº¤äº’ã€æ‹–æ‹½ã€å¸é™„é€»è¾‘)
â”‚   â”‚   â”œâ”€â”€ MapSlot.ts      # ç›®æ ‡æ§½ä½ (åœ°å›¾è½®å»“)
â”‚   â”‚   â””â”€â”€ FallingObject.ts# æ‰è½ç‰© (Level 2 æ ¸å¿ƒå¯¹è±¡)
â”‚   â”œâ”€â”€ scenes/             # æ¸¸æˆåœºæ™¯
â”‚   â”‚   â”œâ”€â”€ BootScene.ts    # å¯åŠ¨ä¸èµ„æºåŠ è½½ (ç›®å‰è·³è¿‡ StartScene ç”¨äºæµ‹è¯•)
â”‚   â”‚   â”œâ”€â”€ StartScene.ts   # å¼€å§‹ç•Œé¢ (æ ‡é¢˜ & Play æŒ‰é’®)
â”‚   â”‚   â”œâ”€â”€ GameScene.ts    # Level 1 ä¸»åœºæ™¯
â”‚   â”‚   â””â”€â”€ Level2Scene.ts  # Level 2 ä¸»åœºæ™¯
â”‚   â”œâ”€â”€ utils/              # å·¥å…·ç±»
â”‚   â”‚   â””â”€â”€ SoundManager.ts # éŸ³æ•ˆç®¡ç†å™¨ (Pop, Snap, Ding, Click)
â”‚   â”œâ”€â”€ main.ts             # æ¸¸æˆå…¥å£é…ç½®
â”‚   â””â”€â”€ types.ts            # TypeScript ç±»å‹å®šä¹‰
â”œâ”€â”€ index.html              # Web å…¥å£
â”œâ”€â”€ package.json            # ä¾èµ–ç®¡ç†
â””â”€â”€ vite.config.ts          # Vite é…ç½®
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹ (Getting Started)

### 1. å®‰è£…ä¾èµ–
Ensure you have Node.js installed.
```bash
npm install
```

### 2. è¿è¡Œå¼€å‘æœåŠ¡å™¨
```bash
npm run dev
```
æ‰“å¼€æµè§ˆå™¨è®¿é—® `http://localhost:5173`ã€‚

### 3. æ„å»ºç”Ÿäº§ç‰ˆæœ¬
```bash
npm run build
```
è¾“å‡ºæ–‡ä»¶ä½äº `dist/` ç›®å½•ã€‚

### 4. (å¯é€‰) é‡æ–°ç”Ÿæˆåœ°å›¾æ•°æ®
å¦‚æœä¿®æ”¹äº† GeoJSON æºæ•°æ®æˆ–æŠ•å½±å‚æ•°ï¼š
```bash
npm run build-map
```

---

## ğŸ§© æ ¸å¿ƒæ¥å£è¯´æ˜ (Key Interfaces)

### `GameMapData` (src/types.ts)
æ¸¸æˆåŠ è½½çš„æ ¸å¿ƒåœ°å›¾æ•°æ®ç»“æ„ã€‚
```typescript
interface GameMapData {
    width: number;          // åŸå§‹æŠ•å½±å®½åº¦
    height: number;         // åŸå§‹æŠ•å½±é«˜åº¦
    provinces: ProvinceData[];
}
```

### `ProvinceData` (src/types.ts)
å•ä¸ªçœä»½çš„æ•°æ®æè¿°ã€‚
```typescript
interface ProvinceData {
    name: string;           // çœä»½åç§° (e.g., "åŒ—äº¬å¸‚")
    adcode: number;         // è¡Œæ”¿åŒºåˆ’ä»£ç 
    center: { x, y };       // å‡ ä½•ä¸­å¿ƒç‚¹ (ç”¨äºå®šä½)
    points: { x, y }[];     // å¤šè¾¹å½¢é¡¶ç‚¹æ•°ç»„ (ç”¨äºç»˜åˆ¶å½¢çŠ¶)
    bounds: {               // è¾¹ç•Œæ¡† (ç”¨äºç¢°æ’æ£€æµ‹ä¼˜åŒ–)
        minX: number;
        maxX: number;
        minY: number;
        maxY: number;
    };
}
```

### `SoundManager` (src/utils/SoundManager.ts)
å•ä¾‹éŸ³é¢‘ç®¡ç†å™¨ã€‚
*   `playPop()`: æ‹¾èµ·/æ‚¬åœéŸ³æ•ˆã€‚
*   `playSnap()`: å¸é™„æˆåŠŸéŸ³æ•ˆã€‚
*   `playClick()`: ç‚¹å‡»éŸ³æ•ˆã€‚
*   `playDing()`: åŒ¹é…æˆåŠŸéŸ³æ•ˆã€‚
*   `playError()`: é”™è¯¯/å¤±è´¥éŸ³æ•ˆã€‚
